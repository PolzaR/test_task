<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тестовое задание</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <header class="header">
        <div class="wrapper header__wrapper">
            <h1 class="header__title">Импорт в базу данных</h1>
            <div class="buttons">
                <a class="button">Русский</a>
                <a href="index_en.html" class="button button_active">English</a>
            </div>
        </div>
    </header>

    <main class="main">
        <div class="wrapper main__wrapper">
            <nav class="navigation">
                <h2 class="navigation__title">Шаги:</h2>
                <ol>
                    <li class="list__item"><a href="#step1" class="list__link">1. Создать новый запрос</a></li>
                    <li class="list__item"><a href="#step2" class="list__link">2. Указать метод и URL-адрес</a>
                    </li>
                    <li class="list__item"><a href="#step3" class="list__link">3. Заполнить тело запроса</a></li>
                    <li class="list__item"><a href="#step4" class="list__link">4. Написать Pre-request Script</a></li>
                    <li class="list__item"><a href="#step5" class="list__link">5. Отправить запрос и изучить ответ</a>
                    </li>
                </ol>
            </nav>


            <section class="step" id="step1">
                <h3 class="step__title">1. Создать новый запрос</h3>
                <div class="step__wrapper">
                    <p class="step__content">
                        После запуска программы “Postman” в левом верхнему углу экрана вы увидите кнопку <span
                            class="new">NEW</span>.</p>
                    <p class="step__content">
                        <img src="./img/2_start.png" alt="Кнопка NEW находиться в левом верхнем углу" width="750"
                            height="350">
                    </p>
                    <p class="step__content">
                        Нажмите на нее и в открывшемся окне выберите <b><i>Request</i></b>, или Запрос.
                    </p>
                    <p class="step__content">
                        <img src="./img/3_new.png" alt="Созать Request" width="750" height="350">
                    </p>
                    <p class="step__content"> Далее Postman предложит указать имя запроса. Здесь все остается на
                        ваше усмотрение. Мы же пока назовем его import_profile.
                    </p>
                    <p class="step__content"> Спустившись чуть ниже, мы обнаружим поле<i> Request Description</i>, или
                        Описание запроса. Дайте краткое описание запроса. Это сделает жизнь людей, которые работают с
                        вами в одной команде, проще. В противном случае, оставьте его пустым.
                    </p>
                    <p class="step__content">
                        <img src="./img/4_request_name_2.png" alt="Наименование коллекции" width="450" height="500">
                    </p>
                    <p class="step__content"> Последнее поле в данном окне — это выбор коллекции. Коллекции создаются,
                        если вам нужно часто повторять одни и те же запросы с определенными параметрами. Если у вас еще
                        не создана подходящая коллекция, то сейчас самое время создать ее.
                    </p>
                    <p class="step__content"> Нажмите <i>Create Collection</i> (Создать коллекцию), введите название
                        коллекции, например, “Profiles”. Можно также указать папку, в которую хотите сохранить запрос.
                        После этого нажмите галочку или Enter.
                    </p>
                    <p class="step__content"> Подводя итог, кликните на кнопку <i>Save to Profiles</i>. Таким образом,
                        вы
                        сохраняете свой запрос в данной коллекции.
                    </p>
                    <p class="step__content">
                        <img src="./img/gif/request_name_collection.gif" alt="Создание коллекции" width="450"
                            height="530">
                    </p>
                    <p class="step__content"> Итак, мы создали запрос. Теперь необходимо его настроить.
                    </p>
                </div>
            </section>

            <section class="step" id="step2">
                <h3 class="step__title">2. Указать метод и URL-адрес</h3>
                <div class="step__wrapper">
                    <p class="step__content">

                    </p>
                    <p class="step__content">
                        Для начала укажем метод запроса. Для этого надо кликнуть на кнопку <b>GET</b> и в
                        выпадающем списке выбрать необходимый метод. В нашем случае это — <b>POST</b>.
                    </p>
                    <p class="step__content">
                        <img src="./img/gif/method.gif" alt="Выбор метода POST в выпадающем списке" width="750"
                            height="370">
                    </p>
                    <p class="step__content">
                        В центральном поле с текстом <i>“Enter request URL”</i> вам надо указать адрес API, на который
                        вы хотите послать запрос. <br> Укажем: <i>https://ru.altkraft.com/api/v1.1/profiles/import</i>.
                    </p>
                    <p class="step__content">
                        <img src="./img/8_post_url.png" alt="Указываем API URL" width="750" height="250">
                    </p>
                    <p class="step__content">
                        Спускаемся в панель ниже.
                    </p>
                </div>
            </section>

            <section class="step" id="step3">
                <h3 class="step__title">3. Заполнить тело запроса</h3>
                <div class="step__wrapper">
                    <p class="step__content">
                        Переходим на вкладку <b><i>Body</i></b>, или Тело запроса. Здесь указываем данные, которые
                        необходимо отправить с запросом.
                    </p>
                    <p class="step__content">
                        <img src="./img/main_panel.png" alt="Главная панель" width="750" height="370">
                    </p>
                    <p class="step__content">
                        Но прежде, чем это сделать, надо выбрать тип отправляемых данных. В нашем случае укажем
                        тип данных — <b><i>raw</i></b>.
                    </p>
                    <p class="step__content">
                        Кроме того, здесь можно выбрать форму запроса. По умолчанию выбран формат
                        Text. Нам потребуется поменять формат. Кликните на поле Text и выберите <b><i>JSON-формат
                            </i></b> в выпадающем списке.
                    </p>
                    <p class="step__content">
                        <img src="./img/10_raw_json.png" alt="Выбрать формат запроса JSON" width="750" height="300">
                    </p>
                    <p class="step__content">
                        Теперь приступим к заполнению тела запроса.
                    </p>
                    <p class="step__content">
                        Тело нашего запроса будет состоять из JSON-объекта. Объекты JSON записываются в виде пар «ключ:
                        значение».
                    </p>
                    <p class="step__content">
                        Например, ключ <i>"token"</i> и его свойство <i>"52d6346d1d7144bc98c559c64d5cb6cc"</i> будут
                        записаны как:
                        <i>"token": "52d6346d1d7144bc98c559c64d5cb6cc"</i>.
                    </p>
                    <p class="step__content">
                        Именно в таком формате нам необходимо ввести данные профиля, которые мы хотим импортировать в
                        базу данных.
                    </p>
                    <p class="step__content">
                        Следует помнить, что JSON-объекты определяются внутри фигурных скобок <b>{ }</b>. Таким образом,
                        тело нашего запроса будет иметь следующий вид:
                    </p>
                    <pre><code>
{
"token": "52d6346d1d7144bc98c559c64d5cb6cc",
"db_id": 2,
"matching": "email",
"email": "john@example.com",
"data": {
        "_fname": "John",
        "_lname": "Doe",                     
        "_bdate": ""
        }
}                       
                    </code></pre>
                    <p class="step__content">
                        Скопируйте этот код и вставьте его в тело запроса.
                    </p>
                    <p class="step__content">
                        <img src="./img/11_body_full.png" alt="Заполнить тело запроса" width="750" height="250">
                    </p>
                    <p class="step__content">
                        В данном случае мы указали лишь малую часть возможных данных профиля. Чтобы узнать, какую
                        еще информацию можно передать в базу данных, перейдите по ссылке: <a
                            href="https://docs.altcraft.com/display/MPUA/Profile+data+object"
                            class="content__link">Профиль</a>.
                    </p>
                    <p class="step__content">
                        Ниже еще раз показан весь процесс работы со вкладкой Body.
                    </p>
                    <p class="step__content">
                        <img src="./img/gif/fill_in_body.gif" alt="Работа с теолом запроса" width="750" height="300">
                    </p>
                </div>
            </section>

            <section class="step" id="step4">
                <h3 class="step__title">4. Написать Pre-request Script</h3>
                <div class="step__wrapper">
                    <p class="step__content">
                        После заполнения тела запроса необходимо перейти на соседнюю вкладку “Pre-request Script”, или
                        Предварительные скрипты. Pre-request Script используется для проведения дополнительных
                        операций перед запросом.
                    </p>
                    <p class="step__content">
                        <img src="./img/pre-request_script.png" alt="Написание Pre-request script" width="750"
                            height="400">
                    </p>
                    <p class="step__content">
                        В нашем JSON-объекте есть объект <i>“data”</i>, который состоит из трех пар "ключ: значение".
                        Нам нужен только один ключ — <i>“_bdate”</i>, поскольку мы хотим изменить его значение таким
                        образом, чтобы в нем сохранялась текущая дата минус 20 лет.
                    </p>
                    <p class="step__content">
                        Для этого потребуется создать переменную окружения в Pre-request Script. Скопируйте следующий
                        код и вставьте его в окошко Pre-request Script.
                    </p>
                    <pre>
                            <code>
let moment = require('moment');
let string = moment().format();
let year = parseInt(string.slice(0, 4)) - 20;
let currentDateMinusTwentyYears = year + '' + string.slice(4);
pm.variables.set("_bdate_changed", currentDateMinusTwentyYears);</code>
                        </pre>
                    <p class="step__content">
                        <img src="./img/12_script.png" alt="Написание Pre-request script" width="750" height="280">
                    </p>
                    <p class="step__content">
                        В этом коде мы создали переменную окружения <i>“_bdate_changed”</i>. Теперь каждый раз при
                        отправке запроса данная переменная будет сохранять текущую дату, но на 20 лет раньше.
                    </p>
                    <p class="step__content">
                        Внесем эту переменную в тело запроса.
                    </p>
                    <p class="step__content">
                        Для это возвращаемся на вкладку <b><i>Body</i></b>. Ищем объект “data”, а у него свойство —
                        <i>“_bdate”</i>. Удаляем предыдущее значение этого свойства и вставляем переменную
                        “_bdate_changed”. Переменная окружения в программе Postman всегда заключается не только в в
                        кавычки, но и в фигурные скобки. Вот так: <b><i>“{{_bdate_changed}}”</i></b> .
                    </p>
                    <p class="step__content">
                        <img src="./img/gif/variable.gif" alt="Указываем переменную в теле запроса" width="750"
                            height="400">
                    </p>
                    <p class="step__content">
                        Теперь при отправке запроса значение свойства <i>“_bdate”</i> будет изменяться в зависимости от
                        текущей даты.
                    </p>
                </div>
            </section>

            <section class="step" id="step5">
                <h3 class="step__title">5. Отправить запрос</h3>
                <div class="step__wrapper">
                    <p class="step__content">
                        Возвращаемся в верхнюю панель и кликаем синюю кнопку <span class="send">SEND</span>, чтобы
                        отправить запрос.
                    </p>
                    <p class="step__content">
                        <img src="./img/send.png" alt="Получаем ответ запроса" width="750" height="400">
                    </p>
                    <p class="step__content">
                        В самой нижней панели можно увидеть ответ запроса.
                    </p>
                    <p class="step__content">
                        <img src="./img/response.png" alt="Получаем ответ запроса" width="750" height="400">
                    </p>
                    <p>
                        Если напротив поля <i>“error_text”</i> вы видите значение: <i>“Successful operation”</i>,
                        значит, профиль клиента успешно импортирован в базу данных Altkraft Marketing. Поздравляем!
                    </p>
                    <p class="step__content">
                        В противном случае, вы где-то допустили ошибку. Пожалуйста, проверьте еще раз правильность
                        введенных данных.
                    </p>
                </div>
            </section>

        </div>
    </main>

    <button class="button button_active" id="btn_top">Вверх</button>

    <script src="script.js"></script>
</body>

</html>