<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тестовое задание</title>
    <link rel="stylesheet" href="style.css">
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PVX7X7C');</script>
    <!-- End Google Tag Manager -->
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-N5FGX57');</script>
    <!-- End Google Tag Manager -->
    
</head>

<body>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PVX7X7C"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
    <header class="header">
        <div class="wrapper header__wrapper">
            <h1 class="header__title">Импорт в базу данных</h1>
            <div class="buttons">
                <a class="button">Русский</a>
                <a href="index_en.html" class="button button_active">English</a>
            </div>
        </div>
    </header>

    <main class="main">
        <div class="wrapper main__wrapper">
            <nav class="navigation">
                <h2 class="navigation__title">Шаги:</h2>
                <ol>
                    <li class="list__item"><a href="#step1" class="list__link">1. Создать новый запрос</a></li>
                    <li class="list__item"><a href="#step2" class="list__link">2. Указать метод и URL-адрес</a></li>
                    <li class="list__item"><a href="#step3" class="list__link">3. Заполнить тело запроса</a></li>
                    <li class="list__item"><a href="#step4" class="list__link">4. Написать Pre-request Script</a></li>
                    <li class="list__item"><a href="#step5" class="list__link">5. Отправить запрос и изучить ответ</a>
                    </li>
                </ol>
            </nav>


            <section class="step" id="step1">
                <h3 class="step__title">1. Создать новый запрос</h3>
                <div class="step__wrapper">
                    <p class="step__content">
                        После запуска программы “Postman” в левом верхнему углу экрана вы увидите кнопку <span
                            class="new">NEW</span>.</p>
                    <p class="step__content">
                        <img src="./img/2_start.png" alt="Кнопка NEW находится в левом верхнем углу">
                    </p>
                    <p class="step__content">
                        Нажмите на нее и в открывшемся окне выберите <b><i>Request</i></b>, или Запрос.
                    </p>
                    <p class="step__content">
                        <img src="./img/3_new.png" alt="Создать Запрос">
                    </p>
                    <p class="step__content"> Далее Postman предложит указать имя запроса. Здесь все остается на
                        ваше усмотрение. Мы же пока назовем его import_profile.
                    </p>
                    <p class="step__content"> Спустившись чуть ниже, мы обнаружим поле<i> Request Description</i>, или
                        Описание запроса. Дайте краткое описание запроса. Это сделает жизнь людей, которые работают с
                        вами в одной команде, проще. В противном случае, оставьте его пустым.
                    </p>
                    <p class="step__content">
                        <img src="./img/4_request_name_2.png" alt="Дать имя новому запросу">
                    </p>
                    <p class="step__content"> Последнее поле в данном окне — это выбор коллекции. Коллекции создаются,
                        если вам нужно часто повторять одни и те же запросы с определенными параметрами. Если у вас еще
                        не создана подходящая коллекция, то сейчас самое время создать ее.
                    </p>
                    <p class="step__content"> Нажмите <i>Create Collection</i> (Создать коллекцию), введите название
                        коллекции, например, “Profiles”. Можно также указать папку, в которую хотите сохранить запрос.
                        После этого нажмите галочку или Enter.
                    </p>
                    <p class="step__content"> Кликните на кнопку <i>Save to Profiles</i>. Так
                        вы сохраните свой запрос в данной коллекции.
                    </p>
                    <p class="step__content">
                        <img src="./img/gif/request_name_collection.gif" alt="Создание коллекции">
                    </p>
                    <p class="step__content"> Итак, мы создали запрос. Теперь необходимо его настроить.
                    </p>
                </div>
            </section>

            <section class="step" id="step2">
                <h3 class="step__title">2. Указать метод и URL-адрес</h3>
                <div class="step__wrapper">
                    <p class="step__content">

                    </p>
                    <p class="step__content">
                        Для начала укажем метод запроса. Кликните на кнопку <b>GET</b> и в
                        выпадающем списке выберите необходимый метод. В нашем случае это — <b>POST</b>.
                    </p>
                    <p class="step__content">
                        <img src="./img/gif/method.gif" alt="Выбор метода POST в выпадающем списке">
                    </p>
                    <p class="step__content">
                        В центральном поле с текстом <i>“Enter request URL”</i> вам надо указать адрес API, на который
                        вы хотите послать запрос. <br> Укажем: <i>https://ru.altkraft.com/api/v1.1/profiles/import</i>.
                    </p>
                    <p class="step__content">
                        <img src="./img/8_post_url.png" alt="Указываем API URL">
                    </p>
                    <p class="step__content">
                        Спускаемся в панель ниже.
                    </p>
                </div>
            </section>

            <section class="step" id="step3">
                <h3 class="step__title">3. Заполнить тело запроса</h3>
                <div class="step__wrapper">
                    <p class="step__content">
                        Переходим на вкладку <b><i>Body</i></b>, или Тело запроса. Здесь указываем данные, которые
                        необходимо отправить с запросом.
                    </p>
                    <p class="step__content">
                        <img src="./img/main_panel.png" alt="Главная панель">
                    </p>
                    <p class="step__content">
                        Но прежде, чем это сделать, надо выбрать тип отправляемых данных. Мы укажем
                        тип данных — <b><i>raw</i></b>.
                    </p>
                    <p class="step__content">
                        Кроме того, здесь можно выбрать формат запроса. По умолчанию выбран формат
                        Text. Нам потребуется поменять формат. Кликните на поле Text и выберите <b><i>JSON-формат
                            </i></b> в выпадающем списке.
                    </p>
                    <p class="step__content">
                        <img src="./img/10_raw_json.png" alt="Выбрать формат запроса JSON">
                    </p>
                    <p class="step__content">
                        Теперь приступим к заполнению тела запроса.
                    </p>
                    <p class="step__content">
                        Тело нашего запроса будет состоять из JSON-объекта. Объекты JSON записываются в виде пар «ключ:
                        значение».
                    </p>
                    <p class="step__content">
                        Например, ключ <i>"token"</i> и его свойство <i>"52d6346d1d7144bc98c559c64d5cb6cc"</i> будут
                        записаны как: <br><b><i>"token": "52d6346d1d7144bc98c559c64d5cb6cc"</i></b>.
                    </p>
                    <p class="step__content">
                        Именно в таком формате нам необходимо ввести данные профиля, которые мы хотим импортировать в
                        базу данных.
                    </p>
                    <p class="step__content">
                        Следует помнить, что JSON-объекты определяются внутри фигурных скобок <b>{ }</b>. Таким образом,
                        тело нашего запроса будет иметь следующий вид:
                    </p>
                    <pre><code>
{
"token": "52d6346d1d7144bc98c559c64d5cb6cc",
"db_id": 2,
"matching": "email",
"email": "john@example.com",
"data": {
        "_fname": "John",
        "_lname": "Doe",                     
        "_bdate": ""
        }
}                       
                    </code></pre>
                    <p class="step__content">
                        Скопируйте этот код и вставьте его в тело запроса.
                    </p>
                    <p class="step__content">
                        <img src="./img/11_body_full.png" alt="Заполнить тело запроса">
                    </p>
                    <p class="step__content">
                        Сейчас мы указали лишь малую часть возможных данных профиля. Чтобы узнать, какую
                        еще информацию можно передать в базу данных, перейдите по ссылке: <a
                            href="https://docs.altcraft.com/display/MPUA/Profile+data+object"
                            class="content__link">Профиль</a>.
                    </p>
                    <p class="step__content">
                        Ниже еще раз показан весь процесс работы со вкладкой Body.
                    </p>
                    <p class="step__content">
                        <img src="./img/gif/fill_in_body.gif" alt="Работа с телом запроса">
                    </p>
                </div>
            </section>

            <section class="step" id="step4">
                <h3 class="step__title">4. Написать Pre-request Script</h3>
                <div class="step__wrapper">
                    <p class="step__content">
                        После заполнения тела запроса необходимо перейти на соседнюю вкладку “Pre-request Script”, или
                        Предварительные скрипты. Pre-request Script используется для проведения дополнительных
                        операций перед отправлением запроса.
                    </p>
                    <p class="step__content">
                        <img src="./img/pre-request_script.png" alt="Вкладка Pre-request script">
                    </p>
                    <p class="step__content">
                        В нашем JSON-объекте есть объект <i>“data”</i>, который состоит из трех пар "ключ: значение".
                        Нам нужен только один ключ — <i>“_bdate”</i>, поскольку мы хотим изменить его значение таким
                        образом, чтобы в нем сохранялась текущая дата минус 20 лет.
                    </p>
                    <p class="step__content">
                        <img src="./img/11_body_data.png" alt="Объект 'data'">
                    </p>
                    <p class="step__content">
                        Для этого потребуется создать переменную окружения в Pre-request Script. Скопируйте следующий
                        код и вставьте его в окошко Pre-request Script.
                    </p>
                    <pre>
                            <code>
let moment = require('moment');
let string = moment().format();
let year = parseInt(string.slice(0, 4)) - 20;
let currentDateMinusTwentyYears = year + '' + string.slice(4);
pm.variables.set("_bdate_changed", currentDateMinusTwentyYears);</code>
                        </pre>
                    <p class="step__content">
                        <img src="./img/12_script.png" alt="Написание Pre-request script">
                    </p>
                    <p class="step__content">
                        В этом коде мы создали переменную окружения <i>“_bdate_changed”</i>. Теперь каждый раз при
                        отправке запроса данная переменная будет сохранять текущую дату, но на 20 лет раньше.
                    </p>
                    <p class="step__content">
                        Внесем эту переменную в тело запроса.
                    </p>
                    <p class="step__content">
                        Для это возвращаемся на вкладку <b><i>Body</i></b>. Ищем объект “data”, а у него свойство —
                        <i>“_bdate”</i>. Удаляем предыдущее значение этого свойства и вставляем переменную
                        “_bdate_changed”. Переменная окружения в программе Postman всегда заключается не только в
                        кавычки, но и в фигурные скобки. Вот так: <b><i>“{{_bdate_changed}}”</i></b> .
                    </p>
                    <p class="step__content">
                        <img src="./img/gif/variable.gif" alt="Указываем переменную в теле запроса">
                    </p>
                    <p class="step__content">
                        Теперь при отправке запроса значение свойства <i>“_bdate”</i> будет изменяться в зависимости от
                        текущей даты.
                    </p>
                </div>
            </section>

            <section class="step" id="step5">
                <h3 class="step__title">5. Отправить запрос</h3>
                <div class="step__wrapper">
                    <p class="step__content">
                        Возвращаемся в верхнюю панель и кликаем синюю кнопку <span class="send">SEND</span>, чтобы
                        отправить запрос.
                    </p>
                    <p class="step__content">
                        <img src="./img/send.png" alt="Отправляем запрос">
                    </p>
                    <p class="step__content">
                        В самой нижней панели можно увидеть ответ запроса.
                    </p>
                    <p class="step__content">
                        <img src="./img/response.png" alt="Получаем ответ">
                    </p>
                    <p>
                        Если напротив поля <i>“error_text”</i> вы видите значение: <i>“Successful operation”</i>,
                        значит, профиль клиента успешно импортирован в базу данных Altkraft Marketing. Поздравляем!
                    </p>
                    <p class="step__content">
                        В противном случае, вы где-то допустили ошибку. Пожалуйста, проверьте еще раз правильность
                        введенных данных.
                    </p>
                </div>
            </section>

        </div>
    </main>

    <button class="button button_active" id="btn_top">Вверх</button>
    
    <button id="init_sub">Подписаться на уведомления</button> // Кнопка подписки
 

    <script src="script.js"></script>
                            
<!-- START OF ALTCRAFT PIXEL CODE !-->
<script type="text/javascript">
 !function(){var e={url:"https://pxl.polina-zakaryan.dev.altkraft.com/pixel?k=c77FePkyzfqDzaovtcoJ7YyTGRSBuJZvrNYT9LGwWiuVUXYxnc3WAuV&s=5d908cc0bf0d37ef",goals:"",value:parseFloat("0"),timeout:parseInt("0"),after_scroll:JSON.parse("false"),auto_load:JSON.parse("true")},o=function(o,t,n,a){var d=[].concat(o).map(function(e){return encodeURIComponent(e)}).join(","),c=encodeURIComponent(String(t||0)),i=encodeURIComponent(n.matching_mode||""),r=encodeURIComponent(n.db_id||0),u=encodeURIComponent(JSON.stringify(n.match||{})),l=encodeURIComponent(JSON.stringify(n.update||{}));setTimeout(function(){(new Image).src=[e.url,"goals="+d,"value="+c,"db_id="+r,"mmode="+i,"match="+u,"update="+l].join("&")},a)},t=!1,n=function(){t||(t=!0,e.after_scroll?document.addEventListener("scroll",function(){(window.pageYOffset||document.documentElement.scrollTop>0)&&o(e.goals,e.value,{},e.timeout)}):e.auto_load&&o(e.goals,e.value,{},e.timeout))};"complete"===document.readyState||"interactive"===document.readyState?n():window.addEventListener("load",n);window.ak_pixel_push=function(e,t,n,a,d,c){var i=[];Array.isArray(e)?i=e:i[0]=e,o(i,t,{match:n,update:a,matching_mode:d,db_id:c},0)}}();
</script>
<!-- END OF ALTCRAFT PIXEL CODE !-->
</body>

</html>
